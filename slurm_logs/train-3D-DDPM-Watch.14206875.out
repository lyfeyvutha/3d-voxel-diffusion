## SLURM PROLOG ###############################################################
##    Job ID : 14206875
##  Job Name : 3D-DDPM-Watch
##  Nodelist : gpu2001
##      CPUs : 
##  Mem/Node : 32768 MB
## Directory : /oscar/home/cvutha/Desktop/3d-mnist
##   Job Started : Sun Nov 16 11:27:41 AM EST 2025
###############################################################################
==========================================
Training job started on gpu2001.oscar.ccv.brown.edu at Sun Nov 16 11:27:41 AM EST 2025
Job ID: 14206875
==========================================
Dataset directory 'data/khmer1' already exists. Recreating it.
Created dataset directories: 'data/khmer1/train' and 'data/khmer1/val'

Generating data for numeral '·ü°' (1/1)...

 Saved 100/240
 Saved 200/240
 Saved 240/240

 Dataset generation complete. 240 files created (train: 200, val: 40).

 Visualizing a random sample (as a smooth surface)...
Using device: cuda
Weights & Biases initialized.
Loading building blocks...
Found 200 .npy file(s) in /users/cvutha/Desktop/3d-mnist/data/khmer1/train
Found 40 .npy file(s) in /users/cvutha/Desktop/3d-mnist/data/khmer1/val
Validation loader enabled with 40 samples.
Training configured for 50 autoencoder epochs + 3000 diffusion epochs (total 3050).

===== Phase 1: Autoencoder (t=0) =====
[AE] Epoch 0001/50 | Recon MSE: 0.185867 | Recon L1: 0.268852 | Val Recon MSE: 0.012031
[AE] Epoch 0050/50 | Recon MSE: 0.000010 | Recon L1: 0.002239 | Val Recon MSE: 0.000009
Autoencoder early-stop triggered at epoch 50.
Autoencoder phase complete. Best recon loss: 0.000010

===== Phase 2: Diffusion Fine-tuning =====
Saved new best diffusion model at epoch 1 (val_recon MSE 0.265436).
[Diff] Epoch 0001/3000 | Noise MSE: 8.500685 | Recon MSE: 0.014881 | Recon L1: 0.097811 | Total: 0.023382 | Val Diff Recon: 0.265436 | Val Diff Noise: 0.209272
Saved new best diffusion model at epoch 25 (val_recon MSE 0.253042).
Saved new best diffusion model at epoch 35 (val_recon MSE 0.251420).
Saved new best diffusion model at epoch 39 (val_recon MSE 0.240205).
Saved new best diffusion model at epoch 42 (val_recon MSE 0.206026).
[Diff] Epoch 0050/3000 | Noise MSE: 0.313505 | Recon MSE: 0.001738 | Recon L1: 0.037840 | Total: 0.017413 | Val Diff Recon: 0.282871 | Val Diff Noise: 0.086117
Saved new best diffusion model at epoch 56 (val_recon MSE 0.184284).
Saved new best diffusion model at epoch 76 (val_recon MSE 0.163868).
Saved new best diffusion model at epoch 96 (val_recon MSE 0.157450).
[Diff] Epoch 0100/3000 | Noise MSE: 0.165346 | Recon MSE: 0.001790 | Recon L1: 0.038222 | Total: 0.018325 | Val Diff Recon: 0.345760 | Val Diff Noise: 0.052808
Saved new best diffusion model at epoch 109 (val_recon MSE 0.134769).
[Diff] Epoch 0150/3000 | Noise MSE: 0.094189 | Recon MSE: 0.001785 | Recon L1: 0.038188 | Total: 0.015914 | Val Diff Recon: 0.274780 | Val Diff Noise: 0.043173
Saved new best diffusion model at epoch 154 (val_recon MSE 0.127284).
Saved new best diffusion model at epoch 179 (val_recon MSE 0.113712).
[Diff] Epoch 0200/3000 | Noise MSE: 0.072984 | Recon MSE: 0.001772 | Recon L1: 0.038112 | Total: 0.016369 | Val Diff Recon: 0.170053 | Val Diff Noise: 0.041767
Saved new best diffusion model at epoch 204 (val_recon MSE 0.106870).
Saved new best diffusion model at epoch 210 (val_recon MSE 0.085502).
Saved new best diffusion model at epoch 225 (val_recon MSE 0.066125).
[Diff] Epoch 0250/3000 | Noise MSE: 0.074640 | Recon MSE: 0.001813 | Recon L1: 0.038356 | Total: 0.020474 | Val Diff Recon: 0.119375 | Val Diff Noise: 0.071015
Saved new best diffusion model at epoch 261 (val_recon MSE 0.059567).
Saved new best diffusion model at epoch 273 (val_recon MSE 0.052334).
Saved new best diffusion model at epoch 280 (val_recon MSE 0.023719).
[Diff] Epoch 0300/3000 | Noise MSE: 0.082393 | Recon MSE: 0.001888 | Recon L1: 0.038784 | Total: 0.026606 | Val Diff Recon: 0.063937 | Val Diff Noise: 0.033647
Saved new best diffusion model at epoch 314 (val_recon MSE 0.016037).
[Diff] Epoch 0350/3000 | Noise MSE: 0.060364 | Recon MSE: 0.001832 | Recon L1: 0.038423 | Total: 0.022959 | Val Diff Recon: 0.037609 | Val Diff Noise: 0.019400
[Diff] Epoch 0400/3000 | Noise MSE: 0.039268 | Recon MSE: 0.001881 | Recon L1: 0.038634 | Total: 0.017588 | Val Diff Recon: 0.032821 | Val Diff Noise: 0.002846
Saved new best diffusion model at epoch 415 (val_recon MSE 0.013149).
Saved new best diffusion model at epoch 418 (val_recon MSE 0.010452).
Saved new best diffusion model at epoch 429 (val_recon MSE 0.004281).
Saved new best diffusion model at epoch 441 (val_recon MSE 0.003399).
[Diff] Epoch 0450/3000 | Noise MSE: 0.039473 | Recon MSE: 0.002078 | Recon L1: 0.039294 | Total: 0.019841 | Val Diff Recon: 0.013528 | Val Diff Noise: 0.017386
Saved new best diffusion model at epoch 458 (val_recon MSE 0.002356).
Saved new best diffusion model at epoch 478 (val_recon MSE 0.002178).
[Diff] Epoch 0500/3000 | Noise MSE: 0.031340 | Recon MSE: 0.004635 | Recon L1: 0.042869 | Total: 0.020305 | Val Diff Recon: 0.004207 | Val Diff Noise: 0.028638
Saved new best diffusion model at epoch 548 (val_recon MSE 0.002031).
[Diff] Epoch 0550/3000 | Noise MSE: 0.016154 | Recon MSE: 0.003806 | Recon L1: 0.041868 | Total: 0.011883 | Val Diff Recon: 0.004312 | Val Diff Noise: 0.037392
Saved new best diffusion model at epoch 574 (val_recon MSE 0.001970).
[Diff] Epoch 0600/3000 | Noise MSE: 0.061572 | Recon MSE: 0.003208 | Recon L1: 0.040746 | Total: 0.033994 | Val Diff Recon: 0.002971 | Val Diff Noise: 0.102684
[Diff] Epoch 0650/3000 | Noise MSE: 0.041035 | Recon MSE: 0.003762 | Recon L1: 0.041711 | Total: 0.024280 | Val Diff Recon: 0.002549 | Val Diff Noise: 0.045309
[Diff] Epoch 0700/3000 | Noise MSE: 0.024380 | Recon MSE: 0.003052 | Recon L1: 0.040554 | Total: 0.015242 | Val Diff Recon: 0.002404 | Val Diff Noise: 0.043245
[Diff] Epoch 0750/3000 | Noise MSE: 0.053338 | Recon MSE: 0.003211 | Recon L1: 0.040959 | Total: 0.029880 | Val Diff Recon: 0.002161 | Val Diff Noise: 0.046017
[Diff] Epoch 0800/3000 | Noise MSE: 0.021366 | Recon MSE: 0.003571 | Recon L1: 0.041221 | Total: 0.014254 | Val Diff Recon: 0.002527 | Val Diff Noise: 0.033818
Saved new best diffusion model at epoch 833 (val_recon MSE 0.001944).
[Diff] Epoch 0850/3000 | Noise MSE: 0.043076 | Recon MSE: 0.003283 | Recon L1: 0.040812 | Total: 0.024821 | Val Diff Recon: 0.003057 | Val Diff Noise: 0.063039
[Diff] Epoch 0900/3000 | Noise MSE: 0.033679 | Recon MSE: 0.003698 | Recon L1: 0.041598 | Total: 0.020537 | Val Diff Recon: 0.004645 | Val Diff Noise: 0.010807
[Diff] Epoch 0950/3000 | Noise MSE: 0.021189 | Recon MSE: 0.003271 | Recon L1: 0.040595 | Total: 0.013865 | Val Diff Recon: 0.003498 | Val Diff Noise: 0.035773
[Diff] Epoch 1000/3000 | Noise MSE: 0.040118 | Recon MSE: 0.003396 | Recon L1: 0.040835 | Total: 0.023455 | Val Diff Recon: 0.002892 | Val Diff Noise: 0.033026
[Diff] Epoch 1050/3000 | Noise MSE: 0.023536 | Recon MSE: 0.003567 | Recon L1: 0.041163 | Total: 0.015336 | Val Diff Recon: 0.003534 | Val Diff Noise: 0.006448
[Diff] Epoch 1100/3000 | Noise MSE: 0.032562 | Recon MSE: 0.003845 | Recon L1: 0.041637 | Total: 0.020126 | Val Diff Recon: 0.003877 | Val Diff Noise: 0.027619
[Diff] Epoch 1150/3000 | Noise MSE: 0.042136 | Recon MSE: 0.002988 | Recon L1: 0.040039 | Total: 0.024056 | Val Diff Recon: 0.002817 | Val Diff Noise: 0.009837
[Diff] Epoch 1200/3000 | Noise MSE: 0.018411 | Recon MSE: 0.002948 | Recon L1: 0.040145 | Total: 0.012153 | Val Diff Recon: 0.004832 | Val Diff Noise: 0.020283
[Diff] Epoch 1250/3000 | Noise MSE: 0.036832 | Recon MSE: 0.002972 | Recon L1: 0.040289 | Total: 0.021388 | Val Diff Recon: 0.003713 | Val Diff Noise: 0.021488
[Diff] Epoch 1300/3000 | Noise MSE: 0.016533 | Recon MSE: 0.003112 | Recon L1: 0.040493 | Total: 0.011378 | Val Diff Recon: 0.002466 | Val Diff Noise: 0.018401
[Diff] Epoch 1350/3000 | Noise MSE: 0.045692 | Recon MSE: 0.002865 | Recon L1: 0.039873 | Total: 0.025711 | Val Diff Recon: 0.003438 | Val Diff Noise: 0.040425
[Diff] Epoch 1400/3000 | Noise MSE: 0.043525 | Recon MSE: 0.002506 | Recon L1: 0.039433 | Total: 0.024268 | Val Diff Recon: 0.003511 | Val Diff Noise: 0.037372
[Diff] Epoch 1450/3000 | Noise MSE: 0.029298 | Recon MSE: 0.003406 | Recon L1: 0.040626 | Total: 0.018055 | Val Diff Recon: 0.004019 | Val Diff Noise: 0.010206
[Diff] Epoch 1500/3000 | Noise MSE: 0.050556 | Recon MSE: 0.002603 | Recon L1: 0.039571 | Total: 0.027881 | Val Diff Recon: 0.004724 | Val Diff Noise: 0.037970
[Diff] Epoch 1550/3000 | Noise MSE: 0.046848 | Recon MSE: 0.002999 | Recon L1: 0.040230 | Total: 0.026422 | Val Diff Recon: 0.002694 | Val Diff Noise: 0.033917
[Diff] Epoch 1600/3000 | Noise MSE: 0.044862 | Recon MSE: 0.003567 | Recon L1: 0.040816 | Total: 0.025998 | Val Diff Recon: 0.002396 | Val Diff Noise: 0.009824
[Diff] Epoch 1650/3000 | Noise MSE: 0.041976 | Recon MSE: 0.003315 | Recon L1: 0.040502 | Total: 0.024303 | Val Diff Recon: 0.003676 | Val Diff Noise: 0.072258
[Diff] Epoch 1700/3000 | Noise MSE: 0.018528 | Recon MSE: 0.003271 | Recon L1: 0.040408 | Total: 0.012535 | Val Diff Recon: 0.003602 | Val Diff Noise: 0.032611
[Diff] Epoch 1750/3000 | Noise MSE: 0.052847 | Recon MSE: 0.002137 | Recon L1: 0.038731 | Total: 0.028561 | Val Diff Recon: 0.003528 | Val Diff Noise: 0.036857
[Diff] Epoch 1800/3000 | Noise MSE: 0.042713 | Recon MSE: 0.002865 | Recon L1: 0.039842 | Total: 0.024221 | Val Diff Recon: 0.004487 | Val Diff Noise: 0.033732
[Diff] Epoch 1850/3000 | Noise MSE: 0.030258 | Recon MSE: 0.002803 | Recon L1: 0.039810 | Total: 0.017932 | Val Diff Recon: 0.004008 | Val Diff Noise: 0.081413
[Diff] Epoch 1900/3000 | Noise MSE: 0.029383 | Recon MSE: 0.003010 | Recon L1: 0.039912 | Total: 0.017702 | Val Diff Recon: 0.003015 | Val Diff Noise: 0.019757
[Diff] Epoch 1950/3000 | Noise MSE: 0.042809 | Recon MSE: 0.002674 | Recon L1: 0.039478 | Total: 0.024078 | Val Diff Recon: 0.002831 | Val Diff Noise: 0.070241
[Diff] Epoch 2000/3000 | Noise MSE: 0.034660 | Recon MSE: 0.002678 | Recon L1: 0.039672 | Total: 0.020008 | Val Diff Recon: 0.003954 | Val Diff Noise: 0.036023
[Diff] Epoch 2050/3000 | Noise MSE: 0.041098 | Recon MSE: 0.002622 | Recon L1: 0.039537 | Total: 0.023171 | Val Diff Recon: 0.003888 | Val Diff Noise: 0.056712
[Diff] Epoch 2100/3000 | Noise MSE: 0.043628 | Recon MSE: 0.002415 | Recon L1: 0.039221 | Total: 0.024229 | Val Diff Recon: 0.004236 | Val Diff Noise: 0.009976
[Diff] Epoch 2150/3000 | Noise MSE: 0.050780 | Recon MSE: 0.002593 | Recon L1: 0.039332 | Total: 0.027983 | Val Diff Recon: 0.003438 | Val Diff Noise: 0.114885
[Diff] Epoch 2200/3000 | Noise MSE: 0.030078 | Recon MSE: 0.003303 | Recon L1: 0.040541 | Total: 0.018342 | Val Diff Recon: 0.003894 | Val Diff Noise: 0.013532
[Diff] Epoch 2250/3000 | Noise MSE: 0.037019 | Recon MSE: 0.002962 | Recon L1: 0.040005 | Total: 0.021471 | Val Diff Recon: 0.005340 | Val Diff Noise: 0.034209
[Diff] Epoch 2300/3000 | Noise MSE: 0.049966 | Recon MSE: 0.002676 | Recon L1: 0.039542 | Total: 0.027659 | Val Diff Recon: 0.004960 | Val Diff Noise: 0.033909
[Diff] Epoch 2350/3000 | Noise MSE: 0.033275 | Recon MSE: 0.002916 | Recon L1: 0.040095 | Total: 0.019553 | Val Diff Recon: 0.002654 | Val Diff Noise: 0.017181
[Diff] Epoch 2400/3000 | Noise MSE: 0.054786 | Recon MSE: 0.003368 | Recon L1: 0.040447 | Total: 0.030760 | Val Diff Recon: 0.003787 | Val Diff Noise: 0.043366
[Diff] Epoch 2450/3000 | Noise MSE: 0.036918 | Recon MSE: 0.003064 | Recon L1: 0.040078 | Total: 0.021523 | Val Diff Recon: 0.002696 | Val Diff Noise: 0.025210
[Diff] Epoch 2500/3000 | Noise MSE: 0.028414 | Recon MSE: 0.003465 | Recon L1: 0.040669 | Total: 0.017672 | Val Diff Recon: 0.003094 | Val Diff Noise: 0.018574
[Diff] Epoch 2550/3000 | Noise MSE: 0.029246 | Recon MSE: 0.002518 | Recon L1: 0.039385 | Total: 0.017141 | Val Diff Recon: 0.003267 | Val Diff Noise: 0.016990
[Diff] Epoch 2600/3000 | Noise MSE: 0.028533 | Recon MSE: 0.002603 | Recon L1: 0.039366 | Total: 0.016870 | Val Diff Recon: 0.002285 | Val Diff Noise: 0.057460
[Diff] Epoch 2650/3000 | Noise MSE: 0.034075 | Recon MSE: 0.002837 | Recon L1: 0.039653 | Total: 0.019874 | Val Diff Recon: 0.003195 | Val Diff Noise: 0.036801
[Diff] Epoch 2700/3000 | Noise MSE: 0.023071 | Recon MSE: 0.002516 | Recon L1: 0.039329 | Total: 0.014052 | Val Diff Recon: 0.003221 | Val Diff Noise: 0.026086
[Diff] Epoch 2750/3000 | Noise MSE: 0.045138 | Recon MSE: 0.003352 | Recon L1: 0.040659 | Total: 0.025921 | Val Diff Recon: 0.003779 | Val Diff Noise: 0.016648
[Diff] Epoch 2800/3000 | Noise MSE: 0.041608 | Recon MSE: 0.002764 | Recon L1: 0.039873 | Total: 0.023568 | Val Diff Recon: 0.002640 | Val Diff Noise: 0.011326
[Diff] Epoch 2850/3000 | Noise MSE: 0.017978 | Recon MSE: 0.002704 | Recon L1: 0.039673 | Total: 0.011693 | Val Diff Recon: 0.002812 | Val Diff Noise: 0.035774
[Diff] Epoch 2900/3000 | Noise MSE: 0.050718 | Recon MSE: 0.002961 | Recon L1: 0.039970 | Total: 0.028320 | Val Diff Recon: 0.003730 | Val Diff Noise: 0.039861
[Diff] Epoch 2950/3000 | Noise MSE: 0.019045 | Recon MSE: 0.003557 | Recon L1: 0.040626 | Total: 0.013080 | Val Diff Recon: 0.002736 | Val Diff Noise: 0.059509
[Diff] Epoch 3000/3000 | Noise MSE: 0.020222 | Recon MSE: 0.002552 | Recon L1: 0.039362 | Total: 0.012663 | Val Diff Recon: 0.003501 | Val Diff Noise: 0.068577
Diffusion phase complete. Best val_recon MSE: 0.001944
Best diffusion checkpoint came from epoch 0833 at /users/cvutha/Desktop/3d-mnist/outputs/checkpoints/best_model.pth
Final model saved to: /users/cvutha/Desktop/3d-mnist/outputs/checkpoints/final_model.pth
Best diffusion model saved to: /users/cvutha/Desktop/3d-mnist/outputs/checkpoints/best_model.pth
Training job finished at Sun Nov 16 10:41:30 PM EST 2025
==========================================
